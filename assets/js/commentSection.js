(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=document.querySelectorAll("#deleteCommentBtn"),o=async()=>{const e=event.target.parentNode,t=e.dataset.id;console.log(t),await fetch(`/api/comments/${t}/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),e.remove()};t&&t.addEventListener("submit",(async n=>{n.preventDefault();const a=t.querySelector("textarea"),c=a.value,d=e.dataset.id;if(""===c)return;const m=await fetch(`/api/videos/${d}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(201===m.status){a.value="";const{newCommentId:e}=await m.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),a=document.createElement("li");a.dataset.id=t,a.className="video__comment";const c=document.createElement("i");c.className="fas fa-comment";const d=document.createElement("span");d.innerText=`${e}`;const m=document.createElement("button");m.innerText="❌",m.id="deleteCommentBtn",a.appendChild(c),a.appendChild(d),a.appendChild(m),n.prepend(a),m.addEventListener("click",o)})(c,e)}})),n&&(console.log("Button ok!"),n.forEach((e=>e.addEventListener("click",o))))})();